# CONTEXT_PACK.md — Context Pack 规范（稳定）
> **用途**：把“下一回合必须记住的内容”压缩成一个可粘贴的小包（HOT 缓存）。  
> **目标**：稳定、短、小、可机器解析；不承载世界百科，不承载全文规则。  
> **tags**: [context, pack, schema, snapshot]

---
## CP::000 硬约束
- **总长度**：≤ 25 行（建议 ≤ 15 行）
- **字段**：固定键值对（见 CP::100），不新增自由段落
- **语义**：只写“当前局势必要信息”，不写背景历史
- **来源**：State/Event 为主；必要时补 1 条 Canon/Mist 结论（≤1 行）

---
## CP::100 CONTEXT_PACK_NEXT（机器可读）
使用 HTML 注释块，避免污染叙事：
```md
<!-- CONTEXT_PACK_NEXT
t=...
loc=...
pc=...
grace=... debt=... rumor=... heat=...
hp=...
flags=...|...|...
quests=...|...|...
npcs=...|...|...
inventory=...,...,...
timers=...|...|...
hooks=...|...|...
-->
```
### 字段定义（固定）
- `t`：游戏内时间（短）
- `loc`：当前位置（短；可用稳定 ID 或展示名）
- `pc`：PC 名称（可含伪装身份）
- `grace/debt/rumor/heat`：核心指标数值
- `hp`：可选
- `flags`：关键状态标记（`|` 分隔；最多 6 个）
- `quests`：任务状态（`|` 分隔；最多 4 条）
- `npcs`：NPC 关系/状态（`|` 分隔；最多 4 条）
- `inventory`：关键物品（`,` 分隔；最多 5 件）
- `timers`：倒计时/时钟（`|` 分隔；最多 3 条）
- `hooks`：下回合钩子（`|` 分隔；最多 5 条）

---
## CP::200 生产规则（每回合末）
1. 先从本回合“变化”里提取（指标/时钟/任务/NPC/线索）。
2. 再把“玩家下一步必须做选择”的内容写进 `hooks`。
3. 若字段爆了：先删叙事描述，后删低优先级对象，最后合并同类项。

---
## CP::900 示例
示例集见：`engine/mechanics/CONTEXT_PACK_EXAMPLES.md`
